<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"
    />
    <meta name="theme-color" content="#1326FD" />
    <title>MC Recovery Fund - Интерактивный контент</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap&subset=cyrillic"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
      // Initialize theme before page load to prevent flash
      (function () {
        try {
          var saved = localStorage.getItem("theme");
          var tg = window.Telegram && window.Telegram.WebApp;
          var fromTG = tg && tg.colorScheme; // 'dark' | 'light'
          var theme =
            saved && (saved === "light" || saved === "dark")
              ? saved
              : fromTG ||
                (window.matchMedia &&
                window.matchMedia("(prefers-color-scheme: dark)").matches
                  ? "dark"
                  : "light");
          document.documentElement.setAttribute("data-theme", theme);
        } catch (_) {}
      })();
    </script>
  </head>
  <body>
    <!-- App Container -->
    <div id="app" class="app">
      <!-- Top Bar -->
      <header class="topbar">
        <div class="topbar-content">
          <div class="topbar-logo">
            <img
              src="favicon.webp"
              alt="MC Recovery Fund"
              width="28"
              height="28"
              style="border-radius: 6px"
            />
            <span class="topbar-title">MC Recovery Fund</span>
          </div>
          <div style="display: flex; gap: 8px; align-items: center">
            <button
              class="btn-icon"
              id="themeToggle"
              aria-label="Переключить тему"
              title="Переключить тему"
            >
              <svg
                class="theme-icon-sun"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              >
                <path
                  d="M12 4V2m0 20v-2M4 12H2m20 0h-2M5.64 5.64l-1.42-1.42M19.78 19.78l-1.42-1.42M5.64 18.36l-1.42 1.42M19.78 4.22l-1.42 1.42"
                />
                <circle cx="12" cy="12" r="4" fill="currentColor" />
              </svg>
              <svg
                class="theme-icon-moon"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="display: none"
              >
                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
              </svg>
            </button>
            <button class="btn-icon" id="backBtn" aria-label="Назад">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M19 12H5M12 19l-7-7 7-7" />
              </svg>
            </button>
          </div>
        </div>
      </header>

      <!-- Main Content Area -->
      <main id="content" class="content">
        <!-- Screens will be injected here -->
      </main>

      <!-- Loading Skeleton -->
      <div id="skeleton" class="skeleton-screen" style="display: none">
        <div class="skeleton-box skeleton-title"></div>
        <div class="skeleton-box skeleton-text"></div>
        <div class="skeleton-box skeleton-text"></div>
        <div class="skeleton-box skeleton-card"></div>
        <div class="skeleton-box skeleton-card"></div>
      </div>
    </div>

    <!-- Data Loading -->
    <script>
      // Load JSON data
      window.APP_DATA = {
        quizzes: [],
        glossary: [],
        edu: [],
      };

      // Fetch data files
      Promise.all([
        fetch("quizzes.json").then((r) => r.json()),
        fetch("glossary.json").then((r) => r.json()),
        fetch("edu.json").then((r) => r.json()),
      ])
        .then(([quizzes, glossary, edu]) => {
          window.APP_DATA.quizzes = quizzes;
          window.APP_DATA.glossary = glossary;
          window.APP_DATA.edu = edu;
        })
        .catch((err) => {
          console.error("Failed to load data:", err);
          // Fallback: use empty arrays
        });
    </script>
    <script src="app.js"></script>
  </body>
</html>
